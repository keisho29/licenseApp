# ADR: Java クイズアプリ設計方針（Architecture Decision Record）

## ADR-001：クイズアプリ全体のアーキテクチャ決定

**ステータス:** Accepted  
**日付:** 2025-11-15

---

## コンテキスト

Java SE 17（Java Silver 対策）向けのクイズアプリを作成する。  
以下の要件に対応できる柔軟で保守性の高いアーキテクチャが必要：

- 問題はカテゴリ別に大量追加する想定  
- 問題文内でテキストブロックを使いたい（コードもそのまま表示）  
- 単一／複数選択問題に対応  
- 正誤判定・解説表示・成績管理  
- 間違えた問題の復習機能  
- 将来 Web/UI へ発展可能な構造  
- Spring Boot を採用し拡張性を確保

---

## 決定（Decision）

### 1. Spring Boot + Maven + Java 17 を採用

- Spring Initializr を使用してプロジェクト作成  
- Spring Boot 3.x  
- Maven Project  
- Java 17  
- Packaging: Jar  
- 初期はコンソールアプリとして実行し、将来Web化できる構造にする

---

### 2. パッケージ構成（レイヤー構造）
```
com.example.quizapp
├─ domain # Question / Category 等のドメインモデル
├─ questionbank # カテゴリ別の問題定義クラス（6つ）
├─ service # 出題・判定・成績管理ロジック
└─ app # Spring Boot 起動クラス
```

---

### 3. Category（カテゴリ）は enum とし、英語名で管理（表示は日本語）
```
| enum名 | 表示名（日本語） |
|--------|------------------|
| BASICS | 基本文法 |
| CONTROL_FLOW | 制御構文 |
| ARRAY_COLLECTION | 配列・コレクション |
| CLASS_INHERITANCE | クラス・継承・ポリモーフィズム |
| INTERFACE_ABSTRACT | インターフェース・抽象クラス |
| EXCEPTION_API | 例外・API基礎 |
```

---

### 4. Question クラスのフィールド構成（7項目）
```
id : String # BAS-001 形式
questionText : String # テキストブロック使用
choices : List<String> # 4〜8択
correctIndexes : List<Integer># 正解インデックス（複数可）
multipleAnswer : boolean # 単一 or 複数選択
category : Category # 6カテゴリ
explanation : String # テキストブロック
```


---

### 5. 問題IDはカテゴリ別採番（BAS-001形式）
```
<カテゴリ略称>-<3桁番号>
例：BAS-001, CFL-003, ARR-010

略称（確定）：BAS, CFL, ARR, CLS, ITF, EXP

```

採番は最初は手動で行う。

---

### 6. QuestionBank はカテゴリ別クラス分割方式（方式B）
```
questionbank/
├─ BasicsQuestions
├─ ControlFlowQuestions
├─ ArrayCollectionQuestions
├─ ClassInheritanceQuestions
├─ InterfaceAbstractQuestions
└─ ExceptionApiQuestions
```
各クラスは：

```java
public static List<Question> getQuestions();
```

`QuestionBank` が以下を提供：

- `findAll()`  
- `findByCategory(Category)`

---

### 7. QuizService の責務

- モード選択（全カテゴリ / カテゴリ別）
- 出題順シャッフル
- 選択肢シャッフル
- 入力解析（複数選択・カンマ区切り・大文字小文字無視）
- 正誤判定（Set<Integer> 比較）
- 正解数カウント
- 間違えた問題記録（List<Question>）
- 解説表示
- 最終成績表示と誤答ID一覧表示

内部状態：

```java
int totalCount
int correctCount
List<Question> wrongQuestions
```
---

### 8. 間違えた問題は Question の参照ごと保持する

```java
List<Question> wrongQuestions
```

理由：復習モード実装が容易になる。

---

### 9. コーディング順序（決定）

1. Category enum を実装  
2. Question を実装（フィールド・コンストラクタ・バリデーション）  
3. QuizService の骨組みを作成  
4. QuizApplication から QuizService.start() を呼ぶ  
5. QuizService の詳細ロジック（1問処理 → 判定 → 成績）  
6. モード選択（全 / カテゴリ別）  
7. 最後に questionbank（6カテゴリ + QuestionBank）を作成する

---

## 結果

この設計により：

- 大規模な問題数に耐える構造  
- カテゴリ別・全体ミックス出題が自由にできる  
- 複数選択問題・解説表示・復習機能に対応  
- Spring Boot を活かし将来 Web 化にも対応  
- 責務が明確な保守性の高いアーキテクチャを実現

---

